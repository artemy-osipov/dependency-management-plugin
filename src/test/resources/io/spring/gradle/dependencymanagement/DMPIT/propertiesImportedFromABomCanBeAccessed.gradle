plugins {
	id "io.spring.dependency-management"
	id "java"
}

repositories {
	mavenCentral()
}

configurations {
	myConfiguration
}

dependencyManagement {
	imports {
		mavenBom 'io.spring.platform:platform-bom:1.0.1.RELEASE'
	}
	myConfiguration {
		imports {
			mavenBom 'org.springframework.boot:spring-boot-dependencies:1.2.1.RELEASE'
		}
	}
}

task verify {
	def importedProperties = dependencyManagement.importedProperties
	def importedPropertiesOutput = new File("${buildDir}/imported-properties.txt")
	def myConfigurationImportedProperties = dependencyManagement.myConfiguration.importedProperties
	def myConfigurationImportedPropertiesOutput = new File("${buildDir}/myConfiguration-imported-properties.txt")
	doFirst {
		importedPropertiesOutput.parentFile.mkdirs()
		importedProperties.each { key, value ->
			importedPropertiesOutput << "${key} -> ${value}\n"
		}
		myConfigurationImportedPropertiesOutput.parentFile.mkdirs()
		myConfigurationImportedProperties.each { key, value ->
			myConfigurationImportedPropertiesOutput << "${key} -> ${value}\n"
		}
	}
}
