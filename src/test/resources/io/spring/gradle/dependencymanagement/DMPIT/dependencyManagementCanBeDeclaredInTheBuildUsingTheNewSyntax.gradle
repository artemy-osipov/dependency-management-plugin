plugins {
	id "io.spring.dependency-management"
	id "java"
}

repositories {
	mavenCentral()
}

dependencyManagement {
	dependencies {
		dependency 'org.springframework:spring-core:4.0.4.RELEASE'
		dependency('commons-logging:commons-logging:1.1.2') {
			exclude 'foo:bar'
		}
		dependency group:'alpha', name: 'bravo', version: '1.0'
		dependency(group:'charlie', name: 'delta', version: '2.0') {
			exclude group:'bar', name:'baz'
		}
	}
}


task managedVersions {
	def managedVersions = dependencyManagement.managedVersions
	def output = new File("${buildDir}/managed-versions.txt")
	doFirst {
		output.parentFile.mkdirs()
		managedVersions.each { key, value ->
			output << "${key} -> ${value}\n"
		}
	}
}

task exclusions {
	def output = new File("${buildDir}/exclusions.txt")
	def exclusions = project.dependencyManagement.dependencyManagementContainer.getExclusions(null)
	doFirst {
		output.parentFile.mkdirs()
		exclusions.exclusionsByDependency.each { key, value ->
			output << "${key} -> "
			output << value.collect { "${it.groupId}:${it.artifactId}" }
			output << "\n"
		}
		
	}
}